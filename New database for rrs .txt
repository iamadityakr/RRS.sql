
-- Create Database
CREATE DATABASE RailwayReservation;
USE RailwayReservation;

-- User table (Passengers + Visitors)
CREATE TABLE Users (
    user_id INT AUTO_INCREMENT PRIMARY KEY,
    name VARCHAR(100) NOT NULL,
    email VARCHAR(100) UNIQUE,
    phone VARCHAR(15) UNIQUE,
    password VARCHAR(100) NOT NULL,
    user_type ENUM('passenger', 'admin') DEFAULT 'passenger'
);

-- Train table
CREATE TABLE Train (
    train_id INT AUTO_INCREMENT PRIMARY KEY,
    train_name VARCHAR(100) NOT NULL,
    source_station VARCHAR(100),
    destination_station VARCHAR(100),
    total_seats INT NOT NULL,
    available_seats INT NOT NULL,
    departure_time DATETIME,
    arrival_time DATETIME
);

-- Reservation table
CREATE TABLE Reservation (
    reservation_id INT AUTO_INCREMENT PRIMARY KEY,
    user_id INT,
    train_id INT,
    booking_date DATE DEFAULT CURRENT_DATE,
    travel_date DATE,
    seat_number INT,
    status ENUM('booked','cancelled') DEFAULT 'booked',
    FOREIGN KEY (user_id) REFERENCES Users(user_id),
    FOREIGN KEY (train_id) REFERENCES Train(train_id)
);

-- Payment table
CREATE TABLE Payment (
    payment_id INT AUTO_INCREMENT PRIMARY KEY,
    reservation_id INT,
    amount DECIMAL(10,2),
    payment_date DATETIME DEFAULT CURRENT_TIMESTAMP,
    method ENUM('UPI','Card','NetBanking','Cash'),
    FOREIGN KEY (reservation_id) REFERENCES Reservation(reservation_id)
);